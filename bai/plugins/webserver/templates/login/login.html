<!doctype html>
<html class="no-js">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="keywords" content="">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>管理登陆界面</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <link rel="stylesheet" href="./static/css/amazeui.min.css">
    <link rel="stylesheet" href="./static/css/app.css">
</head>
<body>
<div class="am-g" id="app">
    <!-- LOGO -->
    <div class="am-u-sm-12 am-text-center">
        <i class="am-icon-twitch myapp-login-logo"></i>
    </div>
    <!-- 登陆框 -->
    <div class="am-u-sm-11 am-u-sm-centered">
        <form class="am-form">
            <fieldset class="myapp-login-form am-form-set">
                <div class="am-form-group am-form-icon">
                    <i class="am-icon-user"></i>
                    <input type="text" class="myapp-login-input-text am-form-field" placeholder="管理员QQ"
                           v-model="adminQQ">
                </div>
                <div class="am-form-group am-form-icon">
                    <i class="am-icon-lock"></i>
                    <input type="text" class="myapp-login-input-text am-form-field" placeholder="验证码" v-model="vcode">
                </div>
            </fieldset>
            <button type="button" class="myapp-login-form-submit am-btn am-btn-primary am-btn-block " v-on:click="login"
                    v-show="loginShow" v-bind:disabled="loginDisabled">登 陆
            </button>
            <button type="button" class="myapp-login-form-submit am-btn am-btn-primary am-btn-block " v-on:click="getVcode"
                    v-show="vcodeShow" v-bind:disabled="vcodeDisabled">发送验证码
            </button>
        </form>
    </div>

</div>
<!--[if (gte IE 9)|!(IE)]><!-->
<script src="https://unpkg.com/vue/dist/vue.js"></script>
<script src="https://cdn.staticfile.org/axios/0.18.0/axios.min.js"></script>
<script>
    var app = new Vue({
        el: '#app',
        data: {
            adminQQ: '',
            vcode: '',
            vcodeShow: true,
            loginShow: false,
            vcodeDisabled: true,
            loginDisabled: true,
        },
        watch: {
            adminQQ: function (val) {
                console.log(val);
                var reg = /^[1-9][0-9]{4,9}$/gim;
                if (reg.test(val)) { //正则匹配QQ号
                    console.log("OK")
                    app.vcodeDisabled = false
                    app.loginDisabled = true
                    app.loginShow = false
                    app.vcodeShow = true
                } else {
                    console.log("NO")
                    app.vcodeDisabled = true
                    app.loginDisabled = true
                    app.loginShow = false
                    app.vcodeShow = true
                }
            }
        },
        // 在 `methods` 对象中定义方法
        methods: {
            greet: function (event) {
                // `this` 在方法里指当前 Vue 实例
                alert('Hello ' + this.name + '!')
                // `event` 是原生 DOM 事件
                if (event) {
                    alert(event.target.tagName)
                }
            },
            login: function (e) {

            },
            getVcode: function (e) {
                console.log("GETTING VC")
                axios
                    .post('/',{
                        'action':'get',
                        'qq':app.adminQQ
                    })
                    .then(response => (this.info = response))
                    .catch(function (error) { // 请求失败处理
                        console.log(error);
                    });
            }
        }
    })</script>
</body>
</html>